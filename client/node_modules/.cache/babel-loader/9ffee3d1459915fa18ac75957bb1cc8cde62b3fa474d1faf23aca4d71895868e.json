{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\quoct\\\\Data\\\\Projects\\\\secure-book-v2-test (NCKH)\\\\client\\\\src\\\\contexts\\\\AudioContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useRef } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass AudioContextClass {\n  constructor() {\n    this.audio = new Audio();\n    this.isPlaying = false;\n    this.duration = 0;\n    this.albums = [];\n    this.currentIndex = 0;\n    this.isLooping = false;\n    this.backupAlbums = [];\n  }\n  setAlbums(albums) {\n    this.albums = albums;\n\n    // Add more domain before url this albums\n    this.albums = this.albums.map(album => {\n      album.file = process.env.REACT_APP_SERVER_SERVICE + \"/musics/\" + album.albumId + \"/\" + album.file;\n      album.albumCover = process.env.REACT_APP_SERVER_SERVICE + \"/musics/\" + album.albumId + \"/\" + album.albumCover;\n      return album;\n    });\n    if (this.backupAlbums.length === 0) {\n      this.backupAlbums = this.albums;\n    }\n  }\n  addAlbum(album) {\n    album.file = process.env.REACT_APP_SERVER_SERVICE + \"/musics/\" + album.albumId + \"/\" + album.file;\n    album.albumCover = process.env.REACT_APP_SERVER_SERVICE + \"/musics/\" + album.albumId + \"/\" + album.albumCover;\n    this.albums.push(album);\n  }\n  shuffle() {\n    let currentSong = this.albums[this.currentIndex];\n    while (this.albums[this.currentIndex]._id === currentSong._id) {\n      // Create a shallow copy of the albums array before shuffling\n      this.albums = [...this.albums].sort(() => Math.random() - 0.5);\n    }\n\n    /**\r\n     * In JavaScript, when you assign an array to another variable, \r\n     * it creates a reference to the original array, not a new copy.\r\n     * \r\n     * Instead of:\r\n     *  + Usage: the spread operator ([...]) to create a shallow copy of the array. \r\n     */\n\n    /** Error: albums and backupAlbums are the same array\r\n     * \r\n     *   let currentSong = this.albums[this.currentIndex];\r\n     *   while (this.albums[this.currentIndex]._id === currentSong._id) {\r\n     *        this.albums = this.albums.sort(() => Math.random() - 0.5);\r\n     *     }\r\n     */\n  }\n\n  unShuffle() {\n    if (this.backupAlbums.length > 0) {\n      this.albums = this.backupAlbums;\n      console.log(\"this.albums\", this.albums);\n      console.log(this.backupAlbums);\n    }\n  }\n  prevSong() {\n    this.currentIndex++;\n    if (this.currentIndex >= this.albums.length) this.currentIndex = 0;\n    if (this.isPlaying) this.play();\n  }\n  nextSong() {\n    this.currentIndex--;\n    if (this.currentIndex < 0) this.currentIndex = this.albums.length - 1;\n    if (this.isPlaying) this.play();\n  }\n  setDuration(duration) {\n    this.duration = duration;\n  }\n  play(id) {\n    if (id) {\n      this.currentIndex = this.albums.findIndex(album => album._id === id);\n    }\n    if (this.isPlaying) {\n      this.audio.pause();\n    }\n    this.audio.src = this.albums[this.currentIndex].file;\n\n    // Wait audio loaded, nếu không sẽ bị lỗi \"The fetching process for the media resource was aborted by the user agent at the user's request. in audio\"\n    this.audio.oncanplay = () => {\n      this.audio.play();\n      this.isPlaying = true;\n    };\n    this.isPlaying = true;\n  }\n  pause() {\n    this.audio.pause();\n    this.isPlaying = false;\n  }\n  setSongById(id) {\n    this.currentIndex = this.albums.findIndex(album => album._id === id);\n  }\n  getSong() {\n    return this.albums[this.currentIndex];\n  }\n  isEndedAlbum() {\n    return this.currentIndex === this.albums.length - 1;\n  }\n}\nconst AudioContext = /*#__PURE__*/createContext();\nexport const AudioProvider = ({\n  children\n}) => {\n  _s();\n  const audioContextRef = useRef(new AudioContextClass());\n  return /*#__PURE__*/_jsxDEV(AudioContext.Provider, {\n    value: audioContextRef.current,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 5\n  }, this);\n};\n_s(AudioProvider, \"UGdNwH4cktezdR98Xpj2Tne/O0g=\");\n_c = AudioProvider;\nexport const useAudioContext = () => {\n  _s2();\n  const context = useContext(AudioContext);\n  if (!context) {\n    throw new Error('useAudioContext must be used within an AudioProvider');\n  }\n  return context;\n};\n_s2(useAudioContext, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"AudioProvider\");","map":{"version":3,"names":["React","createContext","useContext","useRef","jsxDEV","_jsxDEV","AudioContextClass","constructor","audio","Audio","isPlaying","duration","albums","currentIndex","isLooping","backupAlbums","setAlbums","map","album","file","process","env","REACT_APP_SERVER_SERVICE","albumId","albumCover","length","addAlbum","push","shuffle","currentSong","_id","sort","Math","random","unShuffle","console","log","prevSong","play","nextSong","setDuration","id","findIndex","pause","src","oncanplay","setSongById","getSong","isEndedAlbum","AudioContext","AudioProvider","children","_s","audioContextRef","Provider","value","current","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAudioContext","_s2","context","Error","$RefreshReg$"],"sources":["C:/Users/quoct/Data/Projects/secure-book-v2-test (NCKH)/client/src/contexts/AudioContext.js"],"sourcesContent":["import React, { createContext, useContext, useRef } from 'react';\r\n\r\nclass AudioContextClass {\r\n  constructor() {\r\n    this.audio = new Audio();\r\n    this.isPlaying = false;\r\n    this.duration = 0;\r\n    this.albums = [];\r\n    this.currentIndex = 0;\r\n    this.isLooping = false;\r\n    this.backupAlbums = [];\r\n  }\r\n\r\n  setAlbums(albums) {\r\n    this.albums = albums;\r\n\r\n    // Add more domain before url this albums\r\n    this.albums = this.albums.map((album) => {\r\n      album.file = process.env.REACT_APP_SERVER_SERVICE + \"/musics/\" + album.albumId + \"/\" + album.file;\r\n      album.albumCover = process.env.REACT_APP_SERVER_SERVICE + \"/musics/\" + album.albumId + \"/\" + album.albumCover;\r\n\r\n      return album;\r\n    });\r\n\r\n    if (this.backupAlbums.length === 0) {\r\n      this.backupAlbums = this.albums;\r\n    }\r\n  }\r\n\r\n  addAlbum(album) {\r\n    album.file = process.env.REACT_APP_SERVER_SERVICE + \"/musics/\" + album.albumId + \"/\" + album.file;\r\n    album.albumCover = process.env.REACT_APP_SERVER_SERVICE + \"/musics/\" + album.albumId + \"/\" + album.albumCover;\r\n\r\n    this.albums.push(album);\r\n  }\r\n\r\n  shuffle() {\r\n    let currentSong = this.albums[this.currentIndex];\r\n\r\n    while (this.albums[this.currentIndex]._id === currentSong._id) {\r\n      // Create a shallow copy of the albums array before shuffling\r\n      this.albums = [...this.albums].sort(() => Math.random() - 0.5);\r\n    }\r\n\r\n    /**\r\n     * In JavaScript, when you assign an array to another variable, \r\n     * it creates a reference to the original array, not a new copy.\r\n     * \r\n     * Instead of:\r\n     *  + Usage: the spread operator ([...]) to create a shallow copy of the array. \r\n     */\r\n\r\n    /** Error: albums and backupAlbums are the same array\r\n     * \r\n     *   let currentSong = this.albums[this.currentIndex];\r\n     *   while (this.albums[this.currentIndex]._id === currentSong._id) {\r\n     *        this.albums = this.albums.sort(() => Math.random() - 0.5);\r\n     *     }\r\n     */\r\n  }\r\n\r\n  unShuffle() {\r\n    if (this.backupAlbums.length > 0) {\r\n      this.albums = this.backupAlbums;\r\n\r\n     console.log(\"this.albums\", this.albums)\r\n     console.log(this.backupAlbums)\r\n    }\r\n  }\r\n\r\n  prevSong() {\r\n    this.currentIndex++;\r\n\r\n    if (this.currentIndex >= this.albums.length)\r\n      this.currentIndex = 0;\r\n\r\n    if (this.isPlaying)\r\n      this.play()\r\n  }\r\n\r\n  nextSong() {\r\n    this.currentIndex--;\r\n\r\n    if (this.currentIndex < 0)\r\n      this.currentIndex = this.albums.length - 1\r\n\r\n    if (this.isPlaying)\r\n      this.play()\r\n  }\r\n\r\n  setDuration(duration) {\r\n    this.duration = duration;\r\n  }\r\n\r\n  play(id) {\r\n    if (id) {\r\n      this.currentIndex = this.albums.findIndex((album) => album._id === id);\r\n    }\r\n\r\n    if (this.isPlaying) {\r\n      this.audio.pause();\r\n    }\r\n\r\n    this.audio.src = this.albums[this.currentIndex].file;\r\n\r\n    // Wait audio loaded, nếu không sẽ bị lỗi \"The fetching process for the media resource was aborted by the user agent at the user's request. in audio\"\r\n    this.audio.oncanplay = () => {\r\n      this.audio.play();\r\n      this.isPlaying = true;\r\n    }\r\n\r\n    this.isPlaying = true;\r\n  }\r\n\r\n  pause() {\r\n    this.audio.pause();\r\n    this.isPlaying = false;\r\n  }\r\n  \r\n  setSongById(id) {\r\n    this.currentIndex = this.albums.findIndex((album) => album._id === id);\r\n  }\r\n\r\n  getSong() {\r\n    return this.albums[this.currentIndex];\r\n  }\r\n\r\n  isEndedAlbum() {\r\n    return this.currentIndex === this.albums.length - 1;\r\n  }\r\n}\r\n\r\nconst AudioContext = createContext();\r\n\r\nexport const AudioProvider = ({ children }) => {\r\n  const audioContextRef = useRef(new AudioContextClass());\r\n\r\n  return (\r\n    <AudioContext.Provider value={audioContextRef.current}>\r\n      {children}\r\n    </AudioContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAudioContext = () => {\r\n  const context = useContext(AudioContext);\r\n  if (!context) {\r\n    throw new Error('useAudioContext must be used within an AudioProvider');\r\n  }\r\n  return context;\r\n};\r\n"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,UAAU,EAAEC,MAAM,QAAQ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEjE,MAAMC,iBAAiB,CAAC;EACtBC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACC,KAAK,GAAG,IAAIC,KAAK,CAAC,CAAC;IACxB,IAAI,CAACC,SAAS,GAAG,KAAK;IACtB,IAAI,CAACC,QAAQ,GAAG,CAAC;IACjB,IAAI,CAACC,MAAM,GAAG,EAAE;IAChB,IAAI,CAACC,YAAY,GAAG,CAAC;IACrB,IAAI,CAACC,SAAS,GAAG,KAAK;IACtB,IAAI,CAACC,YAAY,GAAG,EAAE;EACxB;EAEAC,SAASA,CAACJ,MAAM,EAAE;IAChB,IAAI,CAACA,MAAM,GAAGA,MAAM;;IAEpB;IACA,IAAI,CAACA,MAAM,GAAG,IAAI,CAACA,MAAM,CAACK,GAAG,CAAEC,KAAK,IAAK;MACvCA,KAAK,CAACC,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,wBAAwB,GAAG,UAAU,GAAGJ,KAAK,CAACK,OAAO,GAAG,GAAG,GAAGL,KAAK,CAACC,IAAI;MACjGD,KAAK,CAACM,UAAU,GAAGJ,OAAO,CAACC,GAAG,CAACC,wBAAwB,GAAG,UAAU,GAAGJ,KAAK,CAACK,OAAO,GAAG,GAAG,GAAGL,KAAK,CAACM,UAAU;MAE7G,OAAON,KAAK;IACd,CAAC,CAAC;IAEF,IAAI,IAAI,CAACH,YAAY,CAACU,MAAM,KAAK,CAAC,EAAE;MAClC,IAAI,CAACV,YAAY,GAAG,IAAI,CAACH,MAAM;IACjC;EACF;EAEAc,QAAQA,CAACR,KAAK,EAAE;IACdA,KAAK,CAACC,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,wBAAwB,GAAG,UAAU,GAAGJ,KAAK,CAACK,OAAO,GAAG,GAAG,GAAGL,KAAK,CAACC,IAAI;IACjGD,KAAK,CAACM,UAAU,GAAGJ,OAAO,CAACC,GAAG,CAACC,wBAAwB,GAAG,UAAU,GAAGJ,KAAK,CAACK,OAAO,GAAG,GAAG,GAAGL,KAAK,CAACM,UAAU;IAE7G,IAAI,CAACZ,MAAM,CAACe,IAAI,CAACT,KAAK,CAAC;EACzB;EAEAU,OAAOA,CAAA,EAAG;IACR,IAAIC,WAAW,GAAG,IAAI,CAACjB,MAAM,CAAC,IAAI,CAACC,YAAY,CAAC;IAEhD,OAAO,IAAI,CAACD,MAAM,CAAC,IAAI,CAACC,YAAY,CAAC,CAACiB,GAAG,KAAKD,WAAW,CAACC,GAAG,EAAE;MAC7D;MACA,IAAI,CAAClB,MAAM,GAAG,CAAC,GAAG,IAAI,CAACA,MAAM,CAAC,CAACmB,IAAI,CAAC,MAAMC,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC;IAChE;;IAEA;AACJ;AACA;AACA;AACA;AACA;AACA;;IAEI;AACJ;AACA;AACA;AACA;AACA;AACA;EACE;;EAEAC,SAASA,CAAA,EAAG;IACV,IAAI,IAAI,CAACnB,YAAY,CAACU,MAAM,GAAG,CAAC,EAAE;MAChC,IAAI,CAACb,MAAM,GAAG,IAAI,CAACG,YAAY;MAEhCoB,OAAO,CAACC,GAAG,CAAC,aAAa,EAAE,IAAI,CAACxB,MAAM,CAAC;MACvCuB,OAAO,CAACC,GAAG,CAAC,IAAI,CAACrB,YAAY,CAAC;IAC/B;EACF;EAEAsB,QAAQA,CAAA,EAAG;IACT,IAAI,CAACxB,YAAY,EAAE;IAEnB,IAAI,IAAI,CAACA,YAAY,IAAI,IAAI,CAACD,MAAM,CAACa,MAAM,EACzC,IAAI,CAACZ,YAAY,GAAG,CAAC;IAEvB,IAAI,IAAI,CAACH,SAAS,EAChB,IAAI,CAAC4B,IAAI,CAAC,CAAC;EACf;EAEAC,QAAQA,CAAA,EAAG;IACT,IAAI,CAAC1B,YAAY,EAAE;IAEnB,IAAI,IAAI,CAACA,YAAY,GAAG,CAAC,EACvB,IAAI,CAACA,YAAY,GAAG,IAAI,CAACD,MAAM,CAACa,MAAM,GAAG,CAAC;IAE5C,IAAI,IAAI,CAACf,SAAS,EAChB,IAAI,CAAC4B,IAAI,CAAC,CAAC;EACf;EAEAE,WAAWA,CAAC7B,QAAQ,EAAE;IACpB,IAAI,CAACA,QAAQ,GAAGA,QAAQ;EAC1B;EAEA2B,IAAIA,CAACG,EAAE,EAAE;IACP,IAAIA,EAAE,EAAE;MACN,IAAI,CAAC5B,YAAY,GAAG,IAAI,CAACD,MAAM,CAAC8B,SAAS,CAAExB,KAAK,IAAKA,KAAK,CAACY,GAAG,KAAKW,EAAE,CAAC;IACxE;IAEA,IAAI,IAAI,CAAC/B,SAAS,EAAE;MAClB,IAAI,CAACF,KAAK,CAACmC,KAAK,CAAC,CAAC;IACpB;IAEA,IAAI,CAACnC,KAAK,CAACoC,GAAG,GAAG,IAAI,CAAChC,MAAM,CAAC,IAAI,CAACC,YAAY,CAAC,CAACM,IAAI;;IAEpD;IACA,IAAI,CAACX,KAAK,CAACqC,SAAS,GAAG,MAAM;MAC3B,IAAI,CAACrC,KAAK,CAAC8B,IAAI,CAAC,CAAC;MACjB,IAAI,CAAC5B,SAAS,GAAG,IAAI;IACvB,CAAC;IAED,IAAI,CAACA,SAAS,GAAG,IAAI;EACvB;EAEAiC,KAAKA,CAAA,EAAG;IACN,IAAI,CAACnC,KAAK,CAACmC,KAAK,CAAC,CAAC;IAClB,IAAI,CAACjC,SAAS,GAAG,KAAK;EACxB;EAEAoC,WAAWA,CAACL,EAAE,EAAE;IACd,IAAI,CAAC5B,YAAY,GAAG,IAAI,CAACD,MAAM,CAAC8B,SAAS,CAAExB,KAAK,IAAKA,KAAK,CAACY,GAAG,KAAKW,EAAE,CAAC;EACxE;EAEAM,OAAOA,CAAA,EAAG;IACR,OAAO,IAAI,CAACnC,MAAM,CAAC,IAAI,CAACC,YAAY,CAAC;EACvC;EAEAmC,YAAYA,CAAA,EAAG;IACb,OAAO,IAAI,CAACnC,YAAY,KAAK,IAAI,CAACD,MAAM,CAACa,MAAM,GAAG,CAAC;EACrD;AACF;AAEA,MAAMwB,YAAY,gBAAGhD,aAAa,CAAC,CAAC;AAEpC,OAAO,MAAMiD,aAAa,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EAC7C,MAAMC,eAAe,GAAGlD,MAAM,CAAC,IAAIG,iBAAiB,CAAC,CAAC,CAAC;EAEvD,oBACED,OAAA,CAAC4C,YAAY,CAACK,QAAQ;IAACC,KAAK,EAAEF,eAAe,CAACG,OAAQ;IAAAL,QAAA,EACnDA;EAAQ;IAAAM,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACY,CAAC;AAE5B,CAAC;AAACR,EAAA,CARWF,aAAa;AAAAW,EAAA,GAAbX,aAAa;AAU1B,OAAO,MAAMY,eAAe,GAAGA,CAAA,KAAM;EAAAC,GAAA;EACnC,MAAMC,OAAO,GAAG9D,UAAU,CAAC+C,YAAY,CAAC;EACxC,IAAI,CAACe,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CAAC,sDAAsD,CAAC;EACzE;EACA,OAAOD,OAAO;AAChB,CAAC;AAACD,GAAA,CANWD,eAAe;AAAA,IAAAD,EAAA;AAAAK,YAAA,CAAAL,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}