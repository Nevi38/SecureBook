{"ast":null,"code":"import io from 'socket.io-client';\nimport Crypto from '../utils/Crypto.js';\nconst server = process.env.REACT_APP_SEVER_IP + \":\" + process.env.REACT_APP_SERVER_SOCKET;\nconst socket = io(server, {\n  transports: [\"websocket\"]\n});\n\n/*\r\n      \r\n    Dòng này để fix lỗi: Load lại trang dẫn tới mất danh sách chat\r\n      \r\n      [Problem] \r\n        + Khi load lại trang socket trước bị mất kết nối và sau đó kết nối lại (socket id được làm mới)\r\n        + Bên phía server cũng nhận được tín hiệu (connection)\r\n        + getContacts (server) chỉ gửi danh sách chat đến socket id được thêm từ 'add-user'\r\n        \r\n        => Do đó bên server không tìm được socket.id nào\r\n\r\n      [Fix] Thêm socket.id mỗi khi kết nối\r\n    \r\n*/\n\nif (sessionStorage.getItem('userAuth')) {\n  const encoded = sessionStorage.getItem(\"userAuth\");\n  console.log(encoded);\n  const decoded = JSON.parse(Crypto.decrypt(encoded));\n  console.log(decoded);\n  const user = decoded.user;\n  socket.emit('add-user', user._id);\n}\nexport default socket;","map":{"version":3,"names":["io","Crypto","server","process","env","REACT_APP_SEVER_IP","REACT_APP_SERVER_SOCKET","socket","transports","sessionStorage","getItem","encoded","console","log","decoded","JSON","parse","decrypt","user","emit","_id"],"sources":["C:/Users/quoct/Data/Projects/F2C/client/src/socket/socket-client.js"],"sourcesContent":["import io from 'socket.io-client'\r\nimport Crypto from '../utils/Crypto.js';\r\n\r\nconst server =\r\n    process.env.REACT_APP_SEVER_IP + \":\" +\r\n    process.env.REACT_APP_SERVER_SOCKET\r\n    \r\nconst socket = io(server, { transports: [\"websocket\"] });\r\n\r\n/*\r\n      \r\n    Dòng này để fix lỗi: Load lại trang dẫn tới mất danh sách chat\r\n      \r\n      [Problem] \r\n        + Khi load lại trang socket trước bị mất kết nối và sau đó kết nối lại (socket id được làm mới)\r\n        + Bên phía server cũng nhận được tín hiệu (connection)\r\n        + getContacts (server) chỉ gửi danh sách chat đến socket id được thêm từ 'add-user'\r\n        \r\n        => Do đó bên server không tìm được socket.id nào\r\n\r\n      [Fix] Thêm socket.id mỗi khi kết nối\r\n    \r\n*/\r\n\r\nif (sessionStorage.getItem('userAuth')) {\r\n  const encoded = sessionStorage.getItem(\"userAuth\");\r\n  console.log(encoded)\r\n  const decoded = JSON.parse(Crypto.decrypt(encoded));\r\n  console.log(decoded)\r\n  const user = decoded.user\r\n  socket.emit('add-user', user._id)\r\n}\r\n\r\nexport default socket"],"mappings":"AAAA,OAAOA,EAAE,MAAM,kBAAkB;AACjC,OAAOC,MAAM,MAAM,oBAAoB;AAEvC,MAAMC,MAAM,GACRC,OAAO,CAACC,GAAG,CAACC,kBAAkB,GAAG,GAAG,GACpCF,OAAO,CAACC,GAAG,CAACE,uBAAuB;AAEvC,MAAMC,MAAM,GAAGP,EAAE,CAACE,MAAM,EAAE;EAAEM,UAAU,EAAE,CAAC,WAAW;AAAE,CAAC,CAAC;;AAExD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIC,cAAc,CAACC,OAAO,CAAC,UAAU,CAAC,EAAE;EACtC,MAAMC,OAAO,GAAGF,cAAc,CAACC,OAAO,CAAC,UAAU,CAAC;EAClDE,OAAO,CAACC,GAAG,CAACF,OAAO,CAAC;EACpB,MAAMG,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACf,MAAM,CAACgB,OAAO,CAACN,OAAO,CAAC,CAAC;EACnDC,OAAO,CAACC,GAAG,CAACC,OAAO,CAAC;EACpB,MAAMI,IAAI,GAAGJ,OAAO,CAACI,IAAI;EACzBX,MAAM,CAACY,IAAI,CAAC,UAAU,EAAED,IAAI,CAACE,GAAG,CAAC;AACnC;AAEA,eAAeb,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}